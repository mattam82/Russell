\newcommand{\SubConvI}{%
\UAX{SubConv}
{$T \eqbi U$}
{$\subimpl{`G}{(\lambda x. x)}{T}{U}$}
{} 
}

\def\SubProdI{%
\BAX{SubProd}
{$\subimpl{`G}{c_1}{U}{T}$}
{$\subimpl{`G, x : U}{c_2}{V[c_1~x/x]}{W}$}
{$\subimpl{`G}{\lambda f.\lambda x. c_2~(f~(c_1~x))}{\Pi x : T.V}{\Pi x : U.W}$}
{}
}

\def\SubSigmaI{%
\BAX{SubSigma}
{$\subimpl{`G}{c_1}{T}{U}$}
{$\subimpl{`G, x : T}{c_2}{V}{W[c_1~x/x]}$}
{$\subimpl{`G}
  {\lambda (x, y). (c_1~x, c_2~y)}
  {\Sigma x : T. V}{\Sigma x : U. W}$}
{}
}

\def\SubLeftI{\SubSubI}
\def\SubSubI{%
\UAX{SubSub}
%{$`G, x : U \typec P : \Prop$}
{$\subimpl{`G}{c}{U}{V}$}
{$\subimpl{`G}{c `o \pi_1}
  {\mysubset{x}{U}{P}}{V}$}
{}
}
    
\def\SubRightI{\SubProofI}
\def\SubProofI{%
\UAX{SubProof}
%{$`G, x : U \typec P : \Prop$}
{$\subimpl{`G}{c}{T}{U}$}
{$\subimpl{`G}
  {\lambda t : T. \elt{U}{(\lambda x : U.P)}{(c~t)}{?_{P[c~t/x]}}}
  {T}{\mysubset{x}{U}{P}}$}
{}
}

\newcommand{\subimpln}[4]{#1 \typec #2 : \ipt{#3}{{#1}} \subi
  \ipt{#4}{#1}}
\newcommand{\subimplndiff}[6]{#1 \typec #2 : \ipt{#3}{#1} #4 \subi
  \ipt{#5}{#1} #6}
\newcommand{\SubConvC}{
\UAX{SubConv}
{$\ipt{T}{`G} \eqbi \ipt{U}{`G}$}
{$\subimpln{`G}{(\lambda x. x)}{T}{U}$}
{} 
}

\def\SubProdC{%
\BAX{SubProd}
{$\subimpln{`G}{c_1}{U}{T}$}
{$`G, x : \ipt{U}{`G} \typec c_2 : \ipt{V}{`G, x :
  \ipt{T}{`G}}[c_1~x/x] \subi \ipt{W}{`G, x : \ipt{U}{`G}}$}
{$\subimpln{`G}{\lambda f.\lambda x. c_2~(f~(c_1~x))}{\Pi x : T.V}{\Pi x : U.W}$}
{}
}

\def\SubSigmaC{%
\BAX{SubSigma}
{$\subimpln{`G}{c_1}{T}{U}$}
{$`G, x : \ipt{T}{`G} \typec c_2 : \ipt{V}{`G, x : \ipt{T}{`G}} \subi
  \ipt{W}{`G, x : \ipt{T}{`G}}[c_1~x/x]$}
{$\subimpln{`G}
  {\lambda (x, y). (c_1~x, c_2~y)}
  {\Sigma x : T. V}{\Sigma x : U. W}$}
{}
}

\def\SubLeftC{\SubSubC}
\def\SubSubC{%
\UAX{SubSub}
%{$`G, x : U \typec P : \Prop$}
{$\subimpln{`G}{c}{U}{V}$}
{$\subimpln{`G}{c `o \pi_1}
  {\mysubset{x}{U}{P}}{V}$}
{}
}
    
\def\SubRightC{\SubProofC}
\def\SubProofC{%
\UAX{SubProof}
%{$`G, x : U \typec P : \Prop$}
{$\subimpln{`G}{c}{T}{U}$}
{$\subimpln{`G}
  {\lambda t : T. \elt{U}{(\lambda x : U.P)}{(c~t)}{?_{P[c~t/x]}}}
  {T}{\mysubset{x}{U}{P}}$}
{}
}

\def\subtiFig{
\begin{figure}[ht]
  \begin{center}
    \def\fCenter{\subtd}
    
    \vspace{\infvspace}
    \SubConvI\DP

    \vspace{\infvspace}
    \SubProdI\DP

    \vspace{\infvspace}
    \SubSigmaI\DP
    
    \vspace{\infvspace}
    \SubLeftI\DP
    
    \vspace{\infvspace}
    \SubRightI\DP
    
  \end{center}
  \caption{Réécriture de la coercion vers \CCI}
  \label{fig:subtyping-impl-rules}
\end{figure}
}

\def\subticFig{
\begin{figure}[th]
  \begin{center}
    \def\fCenter{\subtd}
    
    \vspace{\infvspace}
    \SubConvC\DP

    \vspace{\infvspace}
    \SubProdC\DP

    \vspace{\infvspace}
    \SubSigmaC\DP
    
    \vspace{\infvspace}
    \SubLeftC\DP
    
    \vspace{\infvspace}
    \SubRightC\DP
    
  \end{center}
  \caption{Réécriture de la coercion vers \CCI}
  \label{fig:subtyping-impl-rules}
\end{figure}
}

\def\subtiShortContent{
  \begin{center}
    \def\fCenter{\subti}
    \SubConvI\DP
    \vspace{\infvspace}
    \SubLeftI\DP

    \vspace{\infvspace}
    \SubRightI\DP

    \vspace{\infvspace}
    \SubProdI\DP
    
    \vspace{\infvspace}
    \SubSigmaI\DP
  \end{center}}

\def\subtiShort{
\begin{figure}[ht]
  \subtiShortContent
  \caption{Réécriture de la coercion vers \CCI}
  \label{fig:subtyping-impl-rules}
\end{figure}
}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "subset-typing"
%%% LaTeX-command: "TEXINPUTS=\"style:.:\" latex"
%%% End: 
