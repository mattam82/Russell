\newcommand{\timpl}[6]{#1 \typea #2 : #3 "~>" #4 \typec #5 : #6}
\newcommand{\subimpl}[4]{#1 \typec #2 : #3 \sub #4}

\def\WfAtomI{
  \UAX{Wf-Atom}
  {}
  {$\wf [] "~>"~\wf []$}
  {}
}  
  
\def\WfVarI{
  \UAX{Wf-Var}
  {$\timpl{`G}{A}{s}{`G'}{A'}{s}$}
  {$\wf `G, x : A "~>"~\wf `G', x : A'$}
  {$s `: \{ \Set, \Prop, \Type(i) \}$}
}

\def\PropSetI{
  \UAX{PropSet}
  {$\wf `G "~>" ~\wf `G'$}
  {$\timpl{`G}{s}{\Type(0)}{`G'}{s}{\Type(0)}$}
  {$s `: \{ \Prop, \Set \}$} 
}

\def\TypeTypeI{
  \UAX{Type}
  {$\wf `G "~>" \wf `G$}
  {$\timpl{`G}{\Type(i)}{\Type(i + 1)}{`G'}{\Type(i)}{\Type(i + 1)}$}
  {}
}

\def\VarI{
  \BAX{Var}
  {$\wf `G "~>"~\wf `G'$}
  {$x : A `: `G "~>" x : A' `: `G'$}
  {$\timpl{`G}{x}{A}{`G'}{x}{A'}$}
  {}
}

\def\ProdI{
  \BAX{Prod}
  {$\timpl{`G}{T}{s1}{`G'}{T'}{s1}$}
  {$\timpl{`G, x : T}{U}{s2}{`G', x : T'}{U'}{s2}$}
  {$\timpl{`G}{\Pi x : T.U}{s2}{`G'}{\Pi x : T'.U'}{s2}$}
  {$(s1, s2) `: \text{{\sc Sort}}$}
}

\def\AbsI{
  \BAX{Abs}
  {$\timpl{`G}{\Pi x : T. U}{s}{`G'}{\Pi x : T'. U'}{s}$}
  {$\timpl{`G, x : T}{M}{U}{`G', x : T'}{M'}{U'}$}
  {$\timpl{`G}{\lambda x : T. M}{\Pi x : T.U}
    {`G'}{\lambda x : T'. M'}{\Pi x : T'.U'}$}
  {}
}

\def\AppI{
  \QAX{App}
  {$\timpl{`G}{f}{T}{`G'}{f'}{T'}$}
  {$\mu~T' `= (\pi, \Pi x : V'. W')$}
  {$\timpl{`G}{u}{U}{`G'}{u'}{U'}$}
  {$\subimpl{`G'}{c}{U'}{V'}$}
  {$\timpl{`G}{f u}{W[u/x]}{`G'}{(\pi~f')~(c~u')}{W'[ c~u' / x ]}$}
  {}
}

\def\LetInI{
  \BAX{LetIn}
  {$\timpl{`G}{t}{T}{`G'}{t'}{T'}$}
  {$\timpl{`G, x : T}{v}{V}{`G', x : T'}{v'}{V'}$}
  {$\timpl{`G}{\letml x = t \inml v}{V[t / x]}
    {`G'}{\letml x = t' \inml v'}{V'[t' / x]}$}
  {}
}

\def\SigmaRI{
  \BAX{Sigma}
  {$\timpl{`G}{T}{s1}{`G'}{T'}{s1}$}
  {$\timpl{`G, x : T}{U}{s2}{`G', x : T'}{U'}{s2}$}
  {$\timpl{`G}{\Sigma x : T.U}{s2}{`G'}{\Sigma x : T'.U'}{s2} $}
  {$(s1, s2) `: \matht{Sort}$}
}


\def\SumInfI{
  \TAXWide{SumInf}
  {$\timpl{`G}{t}{T}{`G'}{t'}{T'}$}
  {$\timpl{`G}{u}{U}{`G'}{u'}{U'}$}
  {$\timpl{`G}{\Sigma \_ : T.U}{s}{`G'}{\Sigma \_ : T'.U'}{s}$}
  {$\timpl{`G}{(t, u)}{\Sigma \_ : T.U}{`G'}{(t', u')}{\Sigma \_ : T'.U'}$}
  {}
}

\def\SumDepI{
  \TAXWide{SumDep}
  {$\timpl{`G}{t}{T}{`G'}{t'}{T'}$}
  {$\timpl{`G}{u}{U[t/x]}{`G'}{u'}{U'[t'/x]}$}
  {$\timpl{`G}{\Sigma x : T.U}{s}{`G'}{\Sigma x : T'.U'}{s}$}
  {$\timpl{`G}{(t, u : U)}{\Sigma x : T.U}{`G'}{(t', u')}{\Sigma x : T'.U'}$}
  {}
}
 
\def\LetSumI{
  \BAX{LetSum}
  {$\timpl{`G}{t}{\Sigma x : T. U}{`G'}{t'}{\Sigma x : T'.U'}$}
  {$\timpl{`G, x : T, u : U}{v}{V}{`G, x : T', u : U'}{v'}{V'}$}
  {$\timpl{`G}{\letml (x, u) = t \inml v}{V}
    {`G'}{\letml (x, u) = t' \inml v'}{V'}$}
  {}
}

\def\SubsetI{
  \BAX{Subset}
  {$\timpl{`G}{U}{\Type}{`G'}{U'}{\Type}$}
  {$\timpl{`G, x : U}{P}{\Prop}{`G', x : U'}{P'}{\Prop} $}
  {$\timpl{`G}{\subset{x}{U}{P}}{\Type}{`G'}{\subset{x}{U'}{P'}}{\Type}$}
  {$$}
}

\def\marginleft{0em}

\def\typeiFig{
\begin{figure}[h]
  \begin{center}
    \def\fCenter{\wf}
    \def\type{\typec}
    
    \WfAtomI\DP

    \vspace{\infvspace}
    \WfVarI\DP
    
    \vspace{\infvspace}
    \PropSetI\DP
    
    \vspace{\infvspace}
    \VarI\DP
    
    \vspace{\infvspace}
    \ProdI\DP
    
    \vspace{\infvspace}
    \AbsI\DP
    
    \vspace{\infvspace}
    \AppI\DP

    \vspace{\infvspace}
    \LetInI\DP
    
    \vspace{\infvspace}
    \SigmaRI\DP

    \vspace{\infvspace}
    \SumInfI\DP

    \vspace{\infvspace}
    \SumDepI\DP
    
    \vspace{\infvspace}
    \LetSumI\DP
    
    \vspace{\infvspace}
    \SubsetI\DP
  \end{center}
  \label{fig:typing-impl-rules}
  \caption{Réecriture du typage vers \CCI}
\end{figure}
}


\def\typemuiFig{
\begin{figure}[h]
  \begin{eqnarray*}
    (f, \subset{x}{U}{P}))   & "=>" & \letml (f, t) = \muimpl~(f, U) \inml (f `o
    \pi_1, t) \\
    x                        & "=>"  & x
  \end{eqnarray*}
  \label{fig:muimpl-definition}
  \caption{Définition de $\muimpl$}
\end{figure}
}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "subset-typing"
%%% LaTeX-command: "TEXINPUTS=\"style:$TEXINPUTS\" latex"
%%% End: 
